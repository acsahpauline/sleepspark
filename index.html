<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sleep Deprivation Analysis | PySpark Project</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #e8f4f8 0%, #f5e6f1 100%);
            color: #2c3e50;
            line-height: 1.6;
            min-height: 100vh;
            padding: 40px 20px;
        }

        .container {
            max-width: 1000px;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            padding: 60px 50px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            margin: 0 auto;
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Landing Page Styles */
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 2px solid #d4e4f7;
        }

        h1 {
            font-size: 2.2rem;
            font-weight: 700;
            color: #1a2332;
            margin-bottom: 20px;
            line-height: 1.3;
        }

        .project-badge {
            display: inline-block;
            background: #c9e4f7;
            color: #2563a8;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 15px;
            letter-spacing: 0.5px;
        }

        .description {
            background: #faf9fb;
            padding: 30px;
            border-radius: 12px;
            border-left: 4px solid #a8c5e6;
            margin-bottom: 40px;
        }

        .description p {
            font-size: 1.05rem;
            color: #4a5568;
            font-weight: 400;
            line-height: 1.8;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: linear-gradient(135deg, #f0f7ff 0%, #fef5f8 100%);
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }

        .stat-number {
            font-size: 1.8rem;
            font-weight: 700;
            color: #2d5a8c;
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #64748b;
            font-weight: 500;
        }

        /* Menu Page Styles */
        .menu-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .menu-title {
            font-size: 2rem;
            font-weight: 700;
            color: #1a2332;
            margin-bottom: 10px;
        }

        .menu-subtitle {
            font-size: 1rem;
            color: #64748b;
        }

        .sections-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .section-card {
            background: linear-gradient(135deg, #f0f7ff 0%, #fef5f8 100%);
            padding: 30px;
            border-radius: 12px;
            border: 2px solid #e2e8f0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .section-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(107, 155, 209, 0.2);
            border-color: #a8c5e6;
        }

        .section-number {
            font-size: 0.85rem;
            color: #2563a8;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .section-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #1a2332;
        }

        /* Section Content Styles */
        .section-content {
            max-width: 100%;
        }

        .section-header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #d4e4f7;
        }

        .section-header h2 {
            font-size: 1.8rem;
            font-weight: 700;
            color: #1a2332;
            margin-bottom: 10px;
        }

        .section-header .breadcrumb {
            font-size: 0.9rem;
            color: #64748b;
        }

        .content-block {
            margin-bottom: 30px;
        }

        .content-block h3 {
            font-size: 1.3rem;
            font-weight: 600;
            color: #2d5a8c;
            margin-bottom: 15px;
        }

        .content-block ul {
            list-style: none;
            padding-left: 0;
        }

        .content-block li {
            padding-left: 25px;
            margin-bottom: 12px;
            position: relative;
            color: #4a5568;
            line-height: 1.7;
        }

        .content-block li::before {
            content: "•";
            color: #6b9bd1;
            font-weight: bold;
            position: absolute;
            left: 8px;
        }

        .content-block li ul {
            margin-top: 10px;
        }

        .content-block li ul li::before {
            content: "◦";
        }

        .images-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
            margin-top: 30px;
        }

        .image-container {
            background: #faf9fb;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
        }

        .image-container img {
            width: 100%;
            height: auto;
            border-radius: 6px;
            display: block;
        }

        .image-caption {
            margin-top: 10px;
            font-size: 0.9rem;
            color: #64748b;
            text-align: center;
            font-weight: 500;
        }

        /* Buttons */
        .btn {
            display: inline-block;
            padding: 14px 32px;
            background: linear-gradient(135deg, #6b9bd1 0%, #9c8bb8 100%);
            color: white;
            text-align: center;
            text-decoration: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
            border: none;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(107, 155, 209, 0.3);
        }

        .btn-block {
            display: block;
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
            padding: 18px 40px;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e1 100%);
            color: #334155;
        }

        .btn-secondary:hover {
            box-shadow: 0 8px 20px rgba(203, 213, 225, 0.3);
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
            margin-top: 40px;
            justify-content: center;
        }

        @media (max-width: 768px) {
            .container {
                padding: 40px 30px;
            }

            h1 {
                font-size: 1.7rem;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .sections-grid {
                grid-template-columns: 1fr;
            }

            .images-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Landing Page -->
    <div id="landing" class="page active">
        <div class="container">
            <div class="header">
                <div class="project-badge">PySpark Analysis Project</div>
                <h1>Sleep Deprivation Unmasked: A PySpark-Driven Analysis of Causes, Impacts, and Future Escalation</h1>
            </div>

            <div class="description">
                <p>This project uses PySpark to analyze sleep deprivation through 7.7 million US accident records (drowsy-driving proxy) combined with lifestyle and teen survey datasets. It uncovers key causes (stress, screen time, night noise), identifies high-risk groups (teens at 62% deprivation, nurses/teachers 85–100%), quantifies real-world impacts (774K crashes in sleep hours), and projects escalation to ~52–58% of adults by 2035. Built with distributed processing, ML (94.5% accuracy), geospatial/time-series insights, and interactive visualizations.</p>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">7.7M</div>
                    <div class="stat-label">Accident Records</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">94.5%</div>
                    <div class="stat-label">ML Accuracy</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">774K</div>
                    <div class="stat-label">Sleep-Hour Crashes</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">52-58%</div>
                    <div class="stat-label">2035 Projection</div>
                </div>
            </div>

            <button class="btn btn-block" onclick="showPage('menu')">Explore Findings →</button>
        </div>
    </div>

    <!-- Menu Page -->
    <div id="menu" class="page">
        <div class="container">
            <div class="menu-header">
                <h2 class="menu-title">Analysis Sections</h2>
                <p class="menu-subtitle">Select a section to explore the findings</p>
            </div>

            <div class="sections-grid">
                <div class="section-card" onclick="showPage('section1')">
                    <div class="section-number">SECTION 1</div>
                    <div class="section-title">Large-Scale Data Processing</div>
                </div>
                <div class="section-card" onclick="showPage('section2')">
                    <div class="section-number">SECTION 2</div>
                    <div class="section-title">Feature Engineering & Temporal Analysis</div>
                </div>
                <div class="section-card" onclick="showPage('section3')">
                    <div class="section-number">SECTION 3</div>
                    <div class="section-title">Statistical Testing & Severity Analysis</div>
                </div>
                <div class="section-card" onclick="showPage('section4')">
                    <div class="section-number">SECTION 4</div>
                    <div class="section-title">Time-Series Analysis</div>
                </div>
                <div class="section-card" onclick="showPage('section5')">
                    <div class="section-number">SECTION 5</div>
                    <div class="section-title">Geospatial Analysis</div>
                </div>
                <div class="section-card" onclick="showPage('section6')">
                    <div class="section-number">SECTION 6</div>
                    <div class="section-title">Gender & Occupation Risk</div>
                </div>
                <div class="section-card" onclick="showPage('section7')">
                    <div class="section-number">SECTION 7</div>
                    <div class="section-title">Age Group & Teen Screen Time</div>
                </div>
                <div class="section-card" onclick="showPage('section8')">
                    <div class="section-number">SECTION 8</div>
                    <div class="section-title">Stress & Noise Pollution</div>
                </div>
                <div class="section-card" onclick="showPage('section9')">
                    <div class="section-number">SECTION 9</div>
                    <div class="section-title">Predictive Modeling</div>
                </div>
                <div class="section-card" onclick="showPage('section10')">
                    <div class="section-number">SECTION 10</div>
                    <div class="section-title">Future Trends & Projection</div>
                </div>
            </div>

            <div class="nav-buttons">
                <button class="btn btn-secondary" onclick="showPage('landing')">← Back to Home</button>
            </div>
        </div>
    </div>

    <!-- Section 1 -->
    <div id="section1" class="page">
        <div class="container">
            <div class="section-content">
                <div class="section-header">
                    <h2>Large-Scale Data Processing</h2>
                    <div class="breadcrumb">Core Big-Data Foundation</div>
                </div>

                <div class="content-block">
                    <ul>
                        <li>Loaded and processed the full 7.7 million-row US Accidents dataset (US_Accidents_March23.csv) using PySpark in Google Colab</li>
                        <li>Demonstrated performance optimization techniques:
                            <ul>
                                <li>Repartitioned from default ~23 partitions to 200 partitions for better parallelism</li>
                                <li>Cached the DataFrame for repeated fast access</li>
                                <li>Inspected and explained the physical execution plan (.explain()) to show query optimization</li>
                            </ul>
                        </li>
                        <li>Proved Spark's scalability advantage:
                            <ul>
                                <li>On a ~3.86 million-row subsample (~50% of total), Pandas failed due to memory limits (maxResultSize exceeded)</li>
                                <li>Spark completed the same operation successfully in ~6 seconds</li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <div class="images-grid">
                    <div class="image-container">
                        <img src="physical-plan.png" alt="Physical Plan">
                        <div class="image-caption">Physical Execution Plan</div>
                    </div>
                    <div class="image-container">
                        <img src="repartition-proof.png" alt="Repartition Proof">
                        <div class="image-caption">Repartition Proof</div>
                    </div>
                    <div class="image-container">
                        <img src="pandas-crash-spark-success.png" alt="Pandas vs Spark">
                        <div class="image-caption">Pandas Crash vs Spark's Success</div>
                    </div>
                    <div class="image-container">
                        <img src="cache-confirmation.png" alt="Cache Confirmation">
                        <div class="image-caption">Cache Confirmation</div>
                    </div>
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="showPage('menu')">← Back to Menu</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Section 4 -->
    <div id="section4" class="page">
        <div class="container">
            <div class="section-content">
                <div class="section-header">
                    <h2>Time-Series Analysis</h2>
                    <div class="breadcrumb">Temporal Patterns & Seasonal Trends</div>
                </div>

                <div class="content-block">
                    <p style="margin-bottom: 20px; color: #4a5568; line-height: 1.8;">Revealed temporal patterns in the 7.7 million+ accident records that align with sleep deprivation and fatigue risk.</p>
                    <ul>
                        <li>Aggregated accidents by hour of day (0–23):
                            <ul>
                                <li>Clear dip during typical sleep hours (midnight to ~5–6 AM), with the lowest counts in the early morning</li>
                                <li>Sharp spikes at morning commute (6–9 AM) and evening rush (4–6 PM) — classic drowsy-driving carryover</li>
                            </ul>
                        </li>
                        <li>Aggregated accidents by season:
                            <ul>
                                <li>Winter highest (~2.3 million accidents), followed by Fall</li>
                                <li>Spring and Summer lower — consistent with longer nights and increased fatigue exposure in winter</li>
                            </ul>
                        </li>
                        <li>Visualized both patterns with bar charts to highlight biological and seasonal influences on crash risk</li>
                    </ul>
                </div>

                <div class="images-grid">
                    <div class="image-container">
                        <img src="accidents-by-hour.png" alt="Accidents by Hour">
                        <div class="image-caption">Accidents by Hour of Day Bar Chart</div>
                    </div>
                    <div class="image-container">
                        <img src="accidents-by-season.png" alt="Accidents by Season">
                        <div class="image-caption">Accidents by Season Bar Chart</div>
                    </div>
                </div>

                <div style="background: #fef5f8; padding: 20px; border-radius: 10px; margin-top: 30px; border-left: 4px solid #d4a5c5;">
                    <strong style="color: #2d5a8c;">Insight:</strong> Temporal patterns strongly support drowsy-driving as a sleep deprivation proxy — crashes concentrate in low-alertness hours and seasons with more darkness/fatigue exposure.
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="showPage('menu')">← Back to Menu</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Section 5 -->
    <div id="section5" class="page">
        <div class="container">
            <div class="section-content">
                <div class="section-header">
                    <h2>Geospatial Analysis</h2>
                    <div class="breadcrumb">Geographic Hotspots & Vulnerable Regions</div>
                </div>

                <div class="content-block">
                    <p style="margin-bottom: 20px; color: #4a5568; line-height: 1.8;">Mapped geographic hotspots of drowsy-window accidents across US states to identify vulnerable regions.</p>
                    <ul>
                        <li>Aggregated total accidents and drowsy-window accidents (00:00–05:59) by state</li>
                        <li>Calculated percentage of accidents occurring in the drowsy window per state</li>
                        <li>Top states by total accidents: CA (1.74M), FL (880k), TX (583k)</li>
                        <li>Top % drowsy-window accidents: WY (16.85%), SD (15.22%), MT (13.84%), ND (13.19%)</li>
                        <li>Created interactive Plotly choropleth map showing drowsy percentage by state (higher red = higher risk)</li>
                    </ul>
                </div>

                <div class="images-grid">
                    <div class="image-container">
                        <img src="top-states-total.png" alt="Top States Total">
                        <div class="image-caption">Top 10 States by Total Accidents</div>
                    </div>
                    <div class="image-container">
                        <img src="top-states-drowsy.png" alt="Top States Drowsy">
                        <div class="image-caption">Top 10 States by Drowsy-Window Accidents</div>
                    </div>
                    <div class="image-container">
                        <img src="top-states-percentage.png" alt="Top States Percentage">
                        <div class="image-caption">Top 10 States by % Drowsy Accidents</div>
                    </div>
                    <div class="image-container">
                        <img src="choropleth-map.png" alt="Choropleth Map">
                        <div class="image-caption">Interactive Choropleth Map</div>
                    </div>
                </div>

                <div style="background: #fef5f8; padding: 20px; border-radius: 10px; margin-top: 30px; border-left: 4px solid #d4a5c5;">
                    <strong style="color: #2d5a8c;">Insight:</strong> Highest proportional drowsy accidents occur in rural and shift-heavy states — suggesting sleep deprivation vulnerability tied to geography, work patterns, and limited transit options.
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="showPage('menu')">← Back to Menu</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Section 6 -->
    <div id="section6" class="page">
        <div class="container">
            <div class="section-content">
                <div class="section-header">
                    <h2>Gender & Occupation Risk</h2>
                    <div class="breadcrumb">Intersectional Sleep Deprivation Analysis</div>
                </div>

                <div class="content-block">
                    <p style="margin-bottom: 20px; color: #4a5568; line-height: 1.8;">Analyzed high-risk sleep deprivation status (Sleep Duration <7h OR Quality of Sleep <6 OR Sleep Disorder present) across occupation and gender using the main Sleep Health and Lifestyle dataset (374 records), with intersectional cross-analysis to reveal combined effects.</p>
                    <ul>
                        <li>By Occupation (top risk groups):
                            <ul>
                                <li>Nurses: ~92% high-risk</li>
                                <li>Teachers: ~88% high-risk</li>
                                <li>Salespeople/Sales Representatives: ~100% high-risk (small sample but consistent)</li>
                                <li>Doctors: ~55% high-risk</li>
                                <li>Engineers, Lawyers, Accountants: lowest risk (~9–19%)</li>
                            </ul>
                        </li>
                        <li>By Gender:
                            <ul>
                                <li>Slight overall female disadvantage in high-stress/shift roles</li>
                                <li>Males sometimes higher in certain professions (e.g. doctors), but females dominate the highest-risk occupations</li>
                            </ul>
                        </li>
                        <li>Intersectional (Occupation + Gender):
                            <ul>
                                <li>Female nurses: 91.8% high-risk (tallest bar in grouped chart)</li>
                                <li>Female teachers: 85.7% high-risk</li>
                                <li>Salesperson roles: ~100% across both genders</li>
                                <li>Engineer & Lawyer roles: <20% for males (lowest overall)</li>
                                <li>Insight: Gender amplifies risk in high-emotional/shift-based jobs — women in nursing/teaching face the heaviest burden</li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <div class="images-grid">
                    <div class="image-container">
                        <img src="gender-occupation-combined.png" alt="Gender Occupation Combined">
                        <div class="image-caption">Combined Gender & Occupation Effect</div>
                    </div>
                    <div class="image-container">
                        <img src="high-risk-occupation.png" alt="High Risk Occupation">
                        <div class="image-caption">High Risk by Occupation</div>
                    </div>
                    <div class="image-container">
                        <img src="high-risk-gender.png" alt="High Risk Gender">
                        <div class="image-caption">High Risk by Gender</div>
                    </div>
                    <div class="image-container">
                        <img src="high-risk-frequency.png" alt="High Risk Frequency">
                        <div class="image-caption">High Risk by Frequency</div>
                    </div>
                </div>

                <div style="background: #fef5f8; padding: 20px; border-radius: 10px; margin-top: 30px; border-left: 4px solid #d4a5c5;">
                    <strong style="color: #2d5a8c;">Insight:</strong> Sleep deprivation disproportionately affects women in high-stress, shift-based roles (nurses/teachers) — intersectional analysis reveals gender amplifies occupational risk. Young adults (18–29) are also a critical vulnerable group across genders.
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="showPage('menu')">← Back to Menu</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Section 7 -->
    <div id="section7" class="page">
        <div class="container">
            <div class="section-content">
                <div class="section-header">
                    <h2>Age Group & Teen Screen Time</h2>
                    <div class="breadcrumb">Youth Vulnerability & Technology Impact</div>
                </div>

                <div class="content-block">
                    <h3 style="font-size: 1.3rem; font-weight: 600; color: #2d5a8c; margin-bottom: 15px;">Key Age Group Findings</h3>
                    <ul>
                        <li>Teens & Young Adults (13–29) are the most affected overall:
                            <ul>
                                <li>Teen dataset (13–19): 62.1% high-risk (<7 hours sleep) — consistently low average sleep (~6.4–6.5 hours) across all teen ages</li>
                                <li>Main lifestyle dataset (18–29): ~70–74% high-risk, average sleep ~6.5 hours</li>
                                <li>Sleep efficiency dataset (younger sample): Better averages (7–9 hours), but still shows younger teens (9–15) often below recommended levels</li>
                            </ul>
                        </li>
                        <li>Middle Adults (30–49): Moderate risk
                            <ul>
                                <li>Main dataset: ~55–60% high-risk</li>
                                <li>Average sleep varies (6.0–7.5 hours) — worse in high-stress career stages (30s/40s)</li>
                            </ul>
                        </li>
                        <li>Older Adults (50+): Lowest risk
                            <ul>
                                <li>Main dataset: ~28–30% high-risk</li>
                                <li>Better sleep duration and quality — likely due to established routines, less screen time, fewer work demands</li>
                            </ul>
                        </li>
                    </ul>

                    <h3 style="font-size: 1.3rem; font-weight: 600; color: #2d5a8c; margin: 30px 0 15px 0;">Specific Effects on Teens</h3>
                    <p style="margin-bottom: 15px; color: #4a5568; line-height: 1.8;">Teens show the highest and most consistent deprivation:</p>
                    <ul>
                        <li>Phone/Tech Addiction Impact (teen dataset):
                            <ul>
                                <li>61–62% deprived across every daily usage bin (<2h to 8h+): no safe threshold</li>
                                <li>Average sleep stuck at ~6.4–6.5 hours regardless of usage level</li>
                                <li>Screen time before bed, phone checks per day, social media/gaming time all correlate with shorter sleep</li>
                            </ul>
                        </li>
                        <li>Other teen-specific factors:
                            <ul>
                                <li>High anxiety/depression levels linked to poor sleep (from same dataset)</li>
                                <li>Low exercise frequency and high parental control gaps worsen outcomes</li>
                                <li>School grade/age progression doesn't improve sleep, remains chronically short</li>
                            </ul>
                        </li>
                        <li>Long-term implication:
                            <ul>
                                <li>Teens already at 62% deprivation in 2025, if this carries into adulthood (as tech habits solidify), future adult deprivation rates could accelerate beyond current projections (52–58% by 2035)</li>
                                <li>This group is the canary in the coal mine for modern causes (screens, stress, always-on culture)</li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <div class="images-grid">
                    <div class="image-container">
                        <img src="sleep-by-phone-usage.png" alt="Sleep by Phone Usage">
                        <div class="image-caption">Average Sleep Hours by Daily Phone Usage</div>
                    </div>
                    <div class="image-container">
                        <img src="sleep-metrics-phone.png" alt="Sleep Metrics Phone">
                        <div class="image-caption">Sleep Metrics by Phone Usage Table</div>
                    </div>
                    <div class="image-container">
                        <img src="high-risk-age-group.png" alt="High Risk Age">
                        <div class="image-caption">High Risk Percentage by Age Group</div>
                    </div>
                </div>

                <div style="background: #fef5f8; padding: 20px; border-radius: 10px; margin-top: 30px; border-left: 4px solid #d4a5c5;">
                    <strong style="color: #2d5a8c;">Insight:</strong> Teens and young adults face the highest sleep deprivation: 62.1% in the teen dataset (average ~6.5h sleep) with no safe screen-time threshold. This group signals future escalation as tech habits persist into adulthood.
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="showPage('menu')">← Back to Menu</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Section 8 -->
    <div id="section8" class="page">
        <div class="container">
            <div class="section-content">
                <div class="section-header">
                    <h2>Stress & Noise Pollution</h2>
                    <div class="breadcrumb">Dominant Psychological & Environmental Causes</div>
                </div>

                <div class="content-block">
                    <h3 style="font-size: 1.3rem; font-weight: 600; color: #2d5a8c; margin-bottom: 15px;">Stress Levels</h3>
                    <p style="margin-bottom: 15px; color: #4a5568; line-height: 1.8;">Stress was the dominant cause across every dataset and model, it showed up everywhere as the biggest predictor of poor sleep.</p>
                    <p style="margin-bottom: 15px; color: #4a5568; font-weight: 600;">Key findings:</p>
                    <ul>
                        <li>Correlation (main dataset): -0.81 between Stress Level and Sleep Duration — one of the strongest negative links seen</li>
                        <li>By Stress Level (main dataset):
                            <ul>
                                <li>Low stress (3–4): Avg sleep ~7.0–8.2 hours</li>
                                <li>High stress (7–10): Avg sleep ~6.0–6.5 hours</li>
                                <li>Deprivation % jumps dramatically as stress increases</li>
                            </ul>
                        </li>
                        <li>In predictive model: Highest positive coefficient (+2.0318) — far ahead of BMI (+1.52), gender (+1.96), or occupation</li>
                        <li>Teens & young adults: High stress + phone addiction creates a vicious cycle (anxiety/depression → poor sleep → more stress)</li>
                        <li>Occupation link: Shift/high-emotional jobs (nurses, teachers, salespeople) have higher average stress → higher deprivation (85–100% high-risk)</li>
                    </ul>

                    <div style="background: #f0f7ff; padding: 15px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #6b9bd1;">
                        <strong style="color: #2d5a8c;">Insight:</strong> Stress is the most controllable yet pervasive cause — work/life pressure, always-on culture, and shift work amplify it. Reducing stress could have the biggest single impact on sleep.
                    </div>

                    <h3 style="font-size: 1.3rem; font-weight: 600; color: #2d5a8c; margin: 30px 0 15px 0;">Noise Pollution – The Hidden Environmental Cause</h3>
                    <p style="margin-bottom: 15px; color: #4a5568; line-height: 1.8;">Used the urban noise levels dataset (2000 records with decibel levels, lat/long, time, proximity flags) to show how external noise disrupts sleep — especially at night.</p>
                    <p style="margin-bottom: 15px; color: #4a5568; font-weight: 600;">Key findings:</p>
                    <ul>
                        <li>Night-time exposure (22:00–05:59):
                            <ul>
                                <li>Average decibel levels often >40–55 dB (WHO thresholds: >40 dB = disturbance, >55 dB = serious risk)</li>
                                <li>Many measurements exceed safe night levels → frequent awakenings and reduced deep sleep expected</li>
                            </ul>
                        </li>
                        <li>By proximity:
                            <ul>
                                <li>Higher averages near highways, airports, construction sites</li>
                                <li>Urban/high-population-density areas consistently louder at night</li>
                            </ul>
                        </li>
                        <li>% above thresholds: Large portion of night measurements >40 dB (disturbance) and >55 dB (serious) — urban dwellers hit hardest</li>
                        <li>Link to sleep: No direct sleep data in noise set, but research (WHO/EU) shows 10 dB increase in night noise = 10–20 min less sleep + higher insomnia risk</li>
                    </ul>

                    <div style="background: #f0f7ff; padding: 15px; border-radius: 8px; margin: 20px 0; border-left: 4px solid #6b9bd1;">
                        <strong style="color: #2d5a8c;">Insight:</strong> Noise is an uncontrollable external factor — people near traffic/construction can't "fix" it easily. Urbanization + traffic growth could make this worse, especially for shift workers sleeping during the day.
                    </div>
                </div>

                <div class="images-grid">
                    <div class="image-container">
                        <img src="sleep-duration-stress.png" alt="Sleep Duration Stress">
                        <div class="image-caption">Sleep Duration by Stress</div>
                    </div>
                    <div class="image-container">
                        <img src="sleep-quality-bmi.png" alt="Sleep Quality BMI">
                        <div class="image-caption">Sleep Quality by BMI</div>
                    </div>
                    <div class="image-container">
                        <img src="high-risk-exercise.png" alt="High Risk Exercise">
                        <div class="image-caption">High Risk % by Exercise Frequency</div>
                    </div>
                    <div class="image-container">
                        <img src="noise-by-hour.png" alt="Noise by Hour">
                        <div class="image-caption">Average Noise Level by Hour of Day</div>
                    </div>
                    <div class="image-container">
                        <img src="night-noise-proximity.png" alt="Night Noise Proximity">
                        <div class="image-caption">Night Noise: Near vs Away from Major Sources</div>
                    </div>
                    <div class="image-container">
                        <img src="night-noise-plot.png" alt="Night Noise Plot">
                        <div class="image-caption">Night-Time Noise Plot</div>
                    </div>
                    <div class="image-container" style="grid-column: span 2;">
                        <img src="night-noise-stats.png" alt="Night Noise Stats">
                        <div class="image-caption">Night-Time Noise Statistics (22:00 - 05:59)</div>
                    </div>
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="showPage('menu')">← Back to Menu</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Section 9 -->
    <div id="section9" class="page">
        <div class="container">
            <div class="section-content">
                <div class="section-header">
                    <h2>Predictive Modeling</h2>
                    <div class="breadcrumb">Machine Learning with Spark MLlib</div>
                </div>

                <div class="content-block">
                    <p style="margin-bottom: 20px; color: #4a5568; line-height: 1.8;">Built a logistic regression model with Spark MLlib to predict high-risk sleep deprivation status.</p>
                    <ul>
                        <li>Target: Binary High_Risk (1 = Sleep Duration <7h OR Quality <6 OR Sleep Disorder present, else 0)</li>
                        <li>Features: Age, Stress Level, Physical Activity Level, Occupation (indexed), Gender (indexed), BMI Category (indexed)</li>
                        <li>Used StringIndexer for categorical variables and VectorAssembler to combine features</li>
                        <li>Trained/test split (80/20), logistic regression with maxIter=10</li>
                        <li>Performance on test set:
                            <ul>
                                <li>AUC (ROC): 0.958</li>
                                <li>Accuracy: 94.5%</li>
                            </ul>
                        </li>
                        <li>Top drivers from coefficients: Stress Level (+2.03), Gender_Index (+1.96), BMI_Index (+1.52)</li>
                    </ul>
                </div>

                <div class="images-grid">
                    <div class="image-container" style="grid-column: span 2;">
                        <img src="model-performance.png" alt="Model Performance">
                        <div class="image-caption">Model Performance Summary</div>
                    </div>
                </div>

                <div style="background: #fef5f8; padding: 20px; border-radius: 10px; margin-top: 30px; border-left: 4px solid #d4a5c5;">
                    <strong style="color: #2d5a8c;">Insight:</strong> High accuracy/AUC shows sleep deprivation risk can be reliably predicted from basic lifestyle factors — strongest signal from stress level.
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="showPage('menu')">← Back to Menu</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Section 10 -->
    <div id="section10" class="page">
        <div class="container">
            <div class="section-content">
                <div class="section-header">
                    <h2>Future Trends & Projection</h2>
                    <div class="breadcrumb">Escalation Analysis & Forecasting</div>
                </div>

                <div class="content-block">
                    <p style="margin-bottom: 20px; color: #4a5568; line-height: 1.8;">Projected future escalation of sleep deprivation using historical trends and code-based fitting.</p>
                    <ul>
                        <li>Historical data: % adults not getting 7+ hours rose from ~30% (2000) to 60% (2025)</li>
                        <li>Teen dataset reference: already 62.1% deprived in 2025 — ahead of general trend</li>
                        <li>Linear fit: 52.0% (2030), 56.2% (2035) — R² = 0.587, p = 0.026 (significant)</li>
                        <li>Exponential fit (if accelerating): 52.3% (2030), 57.9% (2035) — R² = 0.675, p = 0.012 (stronger fit)</li>
                        <li>Interactive Plotly line chart showing historical rise + projection line + teen dataset marked</li>
                    </ul>
                </div>

                <div class="images-grid">
                    <div class="image-container">
                        <img src="projection-adults.png" alt="Projection Adults">
                        <div class="image-caption">Sleep Deprivation Trend & Projection (Adults)</div>
                    </div>
                    <div class="image-container">
                        <img src="projection-combined.png" alt="Projection Combined">
                        <div class="image-caption">Sleep Deprivation Trend (Teens & Adults)</div>
                    </div>
                    <div class="image-container" style="grid-column: span 2;">
                        <img src="linear-exponential-projection.png" alt="Linear Exponential">
                        <div class="image-caption">Linear and Exponential Projection</div>
                    </div>
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="showPage('menu')">← Back to Menu</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Section 2 -->
    <div id="section2" class="page">
        <div class="container">
            <div class="section-content">
                <div class="section-header">
                    <h2>Feature Engineering & Temporal Analysis</h2>
                    <div class="breadcrumb">Distributed Drowsy-Driving Detection</div>
                </div>

                <div class="content-block">
                    <p style="margin-bottom: 20px; color: #4a5568; line-height: 1.8;">Engineered distributed features to detect drowsy-driving patterns as a proxy for sleep deprivation effects on the full 7.7 million-row dataset.</p>
                    <ul>
                        <li>Created key sleep-related proxy columns directly from the Start_Time timestamp:
                            <ul>
                                <li>Is_Drowsy_Window — boolean flag marking accidents that occurred in the classic drowsy-driving window (00:00–05:59)</li>
                                <li>Is_Night — boolean flag for night-time hours (23:00–05:59)</li>
                                <li>Hour_of_Day, Minute, Day_of_Week, Month, Date, Season — extracted temporal features for time-based analysis</li>
                            </ul>
                        </li>
                        <li>Applied advanced distributed operations at scale:
                            <ul>
                                <li>Used PySpark window functions (Window.partitionBy("State").orderBy("Date").rowsBetween(-6, 0)) to compute rolling 7-day accident counts per state</li>
                                <li>Repartitioned DataFrame for better parallelism and cached enriched versions (df_acc_enriched.cache()) for repeated fast access</li>
                                <li>Broadcast small aggregated data (e.g. stress by occupation from sleep surveys) for potential joins</li>
                            </ul>
                        </li>
                        <li>All transformations executed in distributed mode — no single-node bottlenecks, full leverage of Spark's parallelism</li>
                    </ul>
                </div>

                <div class="images-grid">
                    <div class="image-container">
                        <img src="drowsy-window-sample.png" alt="Drowsy Window Sample">
                        <div class="image-caption">Drowsy Window Sample</div>
                    </div>
                    <div class="image-container">
                        <img src="contingency-table-drowsy.png" alt="True/False Contingency Table">
                        <div class="image-caption">True/False Contingency Table</div>
                    </div>
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="showPage('menu')">← Back to Menu</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Section 3 -->
    <div id="section3" class="page">
        <div class="container">
            <div class="section-content">
                <div class="section-header">
                    <h2>Statistical Testing & Severity Analysis</h2>
                    <div class="breadcrumb">Quantifying Drowsy Window Impact</div>
                </div>

                <div class="content-block">
                    <p style="margin-bottom: 20px; color: #4a5568; line-height: 1.8;">Quantified the impact of drowsy windows on accident severity and performed rigorous statistical testing on the full 7.7 million-row dataset to prove meaningful differences.</p>
                    <ul>
                        <li>Analyzed accident distribution in the drowsy window (00:00–05:59):
                            <ul>
                                <li>10.02% of all accidents occurred during drowsy hours (774,573 crashes out of 7,728,394 total)</li>
                                <li>Average severity slightly higher in drowsy window (2.22) compared to non-drowsy (2.21)</li>
                            </ul>
                        </li>
                        <li>Built contingency table for severity categories:
                            <ul>
                                <li>Binned severity as "High" (≥3) vs "Low" (1–2)</li>
                                <li>Drowsy window: 141,004 high-severity / 633,569 low-severity</li>
                                <li>Non-drowsy window: 1,363,043 high-severity / 5,590,778 low-severity</li>
                            </ul>
                        </li>
                        <li>Conducted chi-square test of independence on severity distribution:
                            <ul>
                                <li>Chi-square statistic: 868.02</li>
                                <li>p-value: 8.80e-191 — extremely significant (far below 0.001 threshold)</li>
                            </ul>
                        </li>
                        <li>Conclusion: The severity distribution of crashes in the drowsy window is statistically significantly different from non-drowsy periods, providing strong evidence that sleep deprivation contributes to more dangerous accident outcomes.</li>
                    </ul>
                </div>

                <div class="images-grid">
                    <div class="image-container">
                        <img src="drowsy-distribution-table.png" alt="Drowsy Window Distribution">
                        <div class="image-caption">Drowsy Window Distribution Table</div>
                    </div>
                    <div class="image-container">
                        <img src="average-severity-comparison.png" alt="Average Severity">
                        <div class="image-caption">Average Severity Comparison</div>
                    </div>
                    <div class="image-container">
                        <img src="contingency-severity-table.png" alt="Contingency Table">
                        <div class="image-caption">Contingency Table (High vs Low Severity)</div>
                    </div>
                    <div class="image-container">
                        <img src="chi-square-result.png" alt="Chi-Square Test">
                        <div class="image-caption">Chi-Square Test Result</div>
                    </div>
                </div>

                <div class="nav-buttons">
                    <button class="btn btn-secondary" onclick="showPage('menu')">← Back to Menu</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            window.scrollTo(0, 0);
        }
    </script>
</body>
</html>